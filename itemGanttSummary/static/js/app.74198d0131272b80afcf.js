webpackJsonp([1],{"+XAg":function(e,t){},"3wvo":function(e,t){},DIJa:function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_slicedToArray__=__webpack_require__("d7EF"),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_slicedToArray___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_slicedToArray__),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_assign__=__webpack_require__("woOf"),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_assign___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_assign__),__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_json_stringify__=__webpack_require__("mvHQ"),__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_json_stringify___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_json_stringify__),__WEBPACK_IMPORTED_MODULE_3_element_ui__=__webpack_require__("zL8q"),__WEBPACK_IMPORTED_MODULE_3_element_ui___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_element_ui__),Tool={returnDatalist:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=this,n=[],a={},i={};return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).forEach(function(e){a[e.node_id]=e.node_name}),e.forEach(function(e){var r=e.deliver_date,o=e.itemInformation,s=e.item_gantt_id,_=e.item_id,l=e.item_name,d=e.node_template_id,c=e.order_time,p=e.style_id,m=e.nodeTemplateMapList,u={deliver_date:r,itemInformation:o,item_gantt_id:s,item_id:_,item_name:l,node_template_id:d,order_time:c,style_id:p,nodedatalist:[]};m.forEach(function(n){var r=e[n.node_id],o=r.is_quote,s=r.first_plant_enddate,_=r.node_id;1!==o||s?0===o&&(!s||"/"!==s&&isNaN(new Date(t._toggleTime(s)).getTime()))&&(i[l]||(i[l]=[]),i[l].push(a[_])):(i[l]||(i[l]=[]),i[l].push(a[_])),u.nodedatalist.push(r)}),n.push(u)}),{datalist:__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_json_stringify___default()(n),errorObj:i}},next_list:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1],n=arguments[2],a=this,i=[],r=!0;return e.forEach(function(n,o){var s={};n.nodeTemplateMapList.map(function(i){if(!i.first_plant_enddate){var _=a._isUsed(e[o].nodeList_0,i.node_code),l=_.status,d=_.time,c=_.name;l&&(Object(__WEBPACK_IMPORTED_MODULE_3_element_ui__.Message)({showClose:!0,message:"此节点已被 "+c+" 引用，请勿置空",type:"warning"}),i.first_plant_enddate=d,r=!1)}var p=i.item_node_change,m=p.frist_plan_time,u=p.abnormal_reason,f=p.is_change,v=p.change_plan_time;if(m&&(u||(Object(__WEBPACK_IMPORTED_MODULE_3_element_ui__.Message)({showClose:!0,message:"请填写 调整/异常原因 后再保存",type:"warning"}),r=!1),1!==f||v||(Object(__WEBPACK_IMPORTED_MODULE_3_element_ui__.Message)({showClose:!0,message:"请选择 调整后日期 后再保存",type:"warning"}),r=!1),m===v&&(Object(__WEBPACK_IMPORTED_MODULE_3_element_ui__.Message)({showClose:!0,message:"系统计算日期 不能等于 调整后日期",type:"warning"}),r=!1),!r)){for(var h="",g=0;g<e[o].nodeList_0.length;g++){var b=e[o].nodeList_0[g];b.node_id===i.node_id&&(h=b.first_plant_enddate)}i.first_plant_enddate=h}s["${"+i.node_code+"}"]=i.first_plant_enddate,i.first_plant_enddate=t?a._toggleTime(i.first_plant_enddate):i.first_plant_enddate,i.error=a._isError(i.max_plant_enddate,i.min_plant_enddate,i.first_plant_enddate),i.item_node_change.abnormal_reason=i.error?i.item_node_change.abnormal_reason:"",n[i.node_id]=i}),s=__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_assign___default()({},n.clacNodeMap,s),n.nodeTemplateMapList.map(function(e){var t=e.max_section_value,i=e.min_section_value,r=e.node_id,o=a._returnTime(t,s),_=a._returnTime(i,s);n[r].max_plant_enddate=o,n[r].min_plant_enddate=_,n[r].maxMinText="最早："+_+"，最晚："+o});var _=__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_assign___default()({},n,{index:2*o});i.push(_);var l=__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_assign___default()({},n,{index:2*o+1});i.push(l)}),n.isSubmit=r,i},_returnTime:function(str,nodeCodeObj){var numStr=str.replace(/[0-9]+/g,function(e){return 60*parseInt(e)*60*24*1e3}).replace(/\$\{[\w-_:/]+\}/g,function(e){return nodeCodeObj[e]?new Date(nodeCodeObj[e]).getTime():0}),d=new Date(eval(numStr)),year=d.getFullYear(),month=d.getMonth()+1<10?"0"+(d.getMonth()+1):d.getMonth()+1,day=d.getDate()<10?"0"+d.getDate():d.getDate();return year+"-"+month+"-"+day},_toggleTime:function(e){if(e){var t=e.split("-"),n=(new Date).getFullYear(),a="",i="";if(3===t.length){var r=__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_slicedToArray___default()(t,3),o=r[0],s=r[1],_=r[2];return isNaN(parseInt(o))||(n="2000".slice(0,-1*String(o).length)+o),isNaN(parseInt(s))||(a=parseInt(s)<10?"0"+parseInt(s):parseInt(s)),isNaN(parseInt(_))||(i=parseInt(_)<10?"0"+parseInt(_):parseInt(_)),parseInt(a)&&parseInt(a)<=12&&parseInt(i)&&parseInt(i)<=31?n+"-"+a+"-"+i:e}if(2===t.length){var l=__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_slicedToArray___default()(t,2),d=l[0],c=l[1];return isNaN(parseInt(d))||(a=parseInt(d)<10?"0"+parseInt(d):parseInt(d)),isNaN(parseInt(c))||(i=parseInt(c)),parseInt(a)&&parseInt(a)<=12&&parseInt(i)&&parseInt(i)<10?n+"-"+a+"-0"+i:parseInt(a)&&parseInt(a)<=12&&parseInt(i)&&parseInt(i)<=31?n+"-"+a+"-"+i:e}return e}return e},_isError:function(e,t,n){var a=new Date(e).getTime(),i=new Date(t).getTime(),r=new Date(n).getTime();return!(i<=r&&r<=a)},_isUsed:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1],n=!1,a="",i=[];return e.forEach(function(e){var r=e.max_section_value,o=e.min_section_value,s=e.sys_clac_formula;e.node_code!==t&&(r.indexOf(t)>-1||o.indexOf(t)>-1||s.indexOf(t)>-1)&&(n=!0,i.push(e.node_name)),e.node_code===t&&(a=e.first_plant_enddate)}),{status:n,time:a,name:i.join("、")}},submitProving:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=[],n=[],a={},i={};return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).forEach(function(e){i[e.node_id]=e.node_name}),e.forEach(function(e){var r=e.node_template_id,o=e.item_id,s=e.item_name,_=e.item_gantt_id,l=void 0===_?"":_,d=e.p_item_gantt_id,c=void 0===d?"":d,p=e.system_material_statistics_id,m=void 0===p?"":p,u=e.plant_id,f={node_template_id:r,item_id:o,item_gantt_id:l,p_item_gantt_id:c,system_material_statistics_id:m,plant_id:void 0===u?"":u,nodedatalist:[]};t.push(o);var v={};e.nodeList_0.forEach(function(e){v[e.node_id]=e}),e.nodeTemplateMapList.forEach(function(e){var t=e.isProving,n=void 0!==t&&t,r=e.error,_=e.node_id,l=e.first_plant_enddate,d=e.node_template_detail_id,c=e.min_plant_enddate,p=e.max_plant_enddate,m=e.item_team_id,u=void 0===m?"":m,h=e.node_charge_person,g=void 0===h?"":h,b=e.item_node_change,I={node_id:_,first_plant_enddate:l,node_template_detail_id:d,min_plant_enddate:c,max_plant_enddate:p,item_team_id:u,node_charge_person:g,item_node_change:b};if(n)f.nodedatalist.push(I);else if(l&&l===v[_].first_plant_enddate)I.item_node_change=__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_assign___default()({},{frist_plan_time:"",abnormal_reason:"",is_change:0,change_plan_time:""}),f.nodedatalist.push(I);else{var w=v[_].first_plant_enddate,T=b.abnormal_reason,x=l;I.item_node_change=__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_assign___default()({},{frist_plan_time:w,abnormal_reason:T,is_change:1,change_plan_time:x}),f.nodedatalist.push(I),r&&!T&&(a[o]||(a[o]={name:s,arr:[]}),a[o].arr.push(i[_]))}}),n.push(f)}),{itemids:t.join(","),datalist:n,nameObj:a}}};__webpack_exports__.a=Tool},K61J:function(e,t){},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("7+uW"),i={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("keep-alive",[t("router-view")],1)],1)},staticRenderFns:[]};var r=n("VU/8")({name:"App"},i,!1,function(e){n("K61J")},null,null).exports,o=n("/ocq"),s=n("fZjL"),_=n.n(s),l=n("Dd8w"),d=n.n(l),c=n("NYxO"),p={data:function(){return{}},created:function(){},computed:d()({},Object(c.c)(["projectList","itemids"]),Object(c.b)(["itenames"])),methods:{chooseProject:function(){var e=this.itemids,t=window.location.origin+"/nova/";win({url:t+"pages/itemganttsummary/choiceItemInfolistGoods.jsp?itemids="+e,param:{},width:1100,height:550,title:"选择项目",onClose:function(){}})},createdTable:function(){this.$store.dispatch("A_getItemNodeTemple",{status:"创建"})}}},m={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"comBox"},[n("div",{staticClass:"formLine"},[e._m(0),e._v(" "),n("div",{staticClass:"formTextBox"},[n("div",{staticClass:"formText"},[n("span",[e._v("本次提报项目：")]),e._v(" "),n("el-popover",{attrs:{"popper-class":"comPopover","visible-arrow":!1,placement:"bottom",trigger:"hover",content:e.itenames}},[n("el-input",{staticClass:"comInput",attrs:{slot:"reference",size:"mini",value:e.itenames,disabled:""},slot:"reference"},[n("el-button",{attrs:{slot:"append"},on:{click:e.chooseProject},slot:"append"},[e._v("选择项目")])],1)],1),e._v(" "),n("span",[e._v("    ")]),e._v(" "),n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.createdTable}},[e._v("创建")]),e._v(" "),n("span",[e._v("    ")]),e._v(" "),e._m(1)],1)])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"formTextBox",staticStyle:{flex:"0"}},[t("div",{staticClass:"formText"},[t("span",[this._v("业务类型：")]),this._v("大货项目 -- 投产前节点提报  \n      ")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{},[t("p",[this._v("系统提示：大货甘特表提报分为以下两步：")]),this._v(" "),t("p",[this._v("1.先指定主线上需手动提报节点计划。2.系统根据模板规则自动生成全部节点计划。")])])}]};var u=n("VU/8")(p,m,!1,function(e){n("tkU7"),n("YvID")},"data-v-55e079ec",null).exports,f=n("d7EF"),v=n.n(f),h={created:function(){this._countHeight()},data:function(){return{value1:"",tableHeight:0}},computed:d()({},Object(c.c)(["projectList","nodeMapList","tableArr"])),methods:{blur:function(e,t){var n=this.projectList,a=this._toggleTime(n[e][t].first_plant_enddate),i=n[e],r=i.order_time,o=i.deliver_date,s=new Date(r).getTime(),_=new Date(o).getTime(),l=new Date(a).getTime();s<=l&&l<=_||0===n[e][t].is_quote&&"/"===a||""===a?this.projectList[e][t].first_plant_enddate=a:(this.$message.error("请输入 下单日期 和 客人交期 之间的时间"),this.projectList[e][t].first_plant_enddate="")},deleteData:function(e){var t=this.projectList;t.splice(e,1),this.$store.commit("saveData",{name:"projectList",obj:t}),this.$store.commit("createdNewTable")},_toggleTime:function(e){if(e){var t=e.split(/[-//.]/g),n=(new Date).getFullYear(),a="",i="";if(3===t.length){var r=v()(t,3),o=r[0],s=r[1],_=r[2];return isNaN(parseInt(o))||(n="2000".slice(0,-1*String(o).length)+o),isNaN(parseInt(s))||(a=parseInt(s)<10?"0"+parseInt(s):parseInt(s)),isNaN(parseInt(_))||(i=parseInt(_)<10?"0"+parseInt(_):parseInt(_)),parseInt(a)&&parseInt(a)<=12&&parseInt(i)&&parseInt(i)<=31?n+"-"+a+"-"+i:e}if(2===t.length){var l=v()(t,2),d=l[0],c=l[1];return isNaN(parseInt(d))||(a=parseInt(d)<10?"0"+parseInt(d):parseInt(d)),isNaN(parseInt(c))||(i=parseInt(c)),parseInt(a)&&parseInt(a)<=12&&parseInt(i)&&parseInt(i)<10?n+"-"+a+"-0"+i:parseInt(a)&&parseInt(a)<=12&&parseInt(i)&&parseInt(i)<=31?n+"-"+a+"-"+i:e}return e}return e},_countHeight:function(){var e=this,t=0,n=setInterval(function(){if(_()(e.$refs).length){var a=e.$refs.comTableBox;a.clientHeight&&(e.tableHeight=a.clientHeight,clearInterval(n))}t>100&&clearInterval(n),t++},100)},_arrIncludes:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=!1,a=0;a<t.length;a++)t[a]===e&&(n=!0);return n}}},g={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"comTableBox",staticClass:"comTableBox"},e._l(e.tableArr,function(t,a){return n("el-table",{directives:[{name:"show",rawName:"v-show",value:a===e.tableArr.length-1,expression:"tableIndex === tableArr.length - 1"}],key:"table_"+t,staticClass:"comTable",attrs:{data:e.projectList,size:"mini",border:"",height:e.tableHeight}},[n("el-table-column",{attrs:{label:"操作",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-popconfirm",{attrs:{title:"确定要删除 "+t.row.item_name+" 吗？",icon:"el-icon-info",iconColor:"red",confirmButtonType:"text"},on:{onConfirm:function(n){e.deleteData(t.row.index)}}},[n("el-tag",{staticClass:"deleteBtn",attrs:{slot:"reference",size:"mini",plain:""},slot:"reference"},[e._v("删除")])],1)]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"项目名称",width:"110"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-popover",{attrs:{"popper-class":"comPopover","visible-arrow":!1,placement:"right",trigger:"hover",content:t.row.itemInformation}},[n("span",{attrs:{slot:"reference"},slot:"reference"},[e._v(e._s(t.row.item_name))])])]}}])}),e._v(" "),n("el-table-column",{attrs:{prop:"order_time",label:"下单日期",width:"110"}}),e._v(" "),n("el-table-column",{attrs:{prop:"deliver_date",label:"客人交期",width:"110"}}),e._v(" "),e._l(e.nodeMapList,function(t){return n("el-table-column",{key:"node_"+t.node_id,attrs:{label:t.node_name,width:"170"},scopedSlots:e._u([{key:"default",fn:function(a){return[!a.row[t.node_id]||"string"!=typeof a.row[t.node_id].first_plant_enddate&&"object"!=typeof a.row[t.node_id].first_plant_enddate?n("span",[e._v("--")]):n("el-input",{staticClass:"comInput",class:1!==a.row[t.node_id].is_quote||a.row[t.node_id].first_plant_enddate?"":"errorPicker",attrs:{slot:"reference",size:"mini",placeholder:1===a.row[t.node_id].is_quote?"请输入日期":"请输入日期或 /"},on:{blur:function(n){e.blur(a.row.index,t.node_id)}},slot:"reference",model:{value:a.row[t.node_id].first_plant_enddate,callback:function(n){e.$set(a.row[t.node_id],"first_plant_enddate",n)},expression:"scope.row[item.node_id].first_plant_enddate"}})]}}])})})],2)}))},staticRenderFns:[]};var b={components:{ComTop:u,ComTable:n("VU/8")(h,g,!1,function(e){n("3wvo"),n("kQc9")},"data-v-346610e4",null).exports},data:function(){return{tableStyle:{},scrollTop:0}},created:function(){var e=(JSON.parse(localStorage.getItem("sumittcpcGanttSummaryType"))||{}).type,t=void 0===e?1:e;this.$store.commit("saveData",{name:"pageType",obj:t}),this._countHeight(),this.$store.dispatch("A_getItemNodeTemple",{}),dg.removeBtn("cancel"),dg.removeBtn("saveAndAdd"),dg.removeBtn("saveAndClose"),dg.removeBtn("saveNoClose")},computed:{},methods:{goTo:function(){this.$store.dispatch("A_generateItemGanttSummary",{that:this})},_countHeight:function(){var e=this,t=0,n=setInterval(function(){if(_()(e.$refs).length){var a=e.$refs,i=a.page,r=a.topBox,o=a.bottomBox;if(i.clientHeight&&r.clientHeight&&o.clientHeight){var s=i.clientHeight-r.clientHeight-o.clientHeight;e.tableStyle={height:s+"px"},clearInterval(n)}}t>100&&clearInterval(n),t++},100)},pageScroll:function(e){var t=e.target.scrollTop,n=this.scrollTop;Math.abs(t-n)<300?(this.scrollTop=e.target.scrollTop,this.$refs.page.scrollTop=t):this.$refs.page.scrollTop=n},arrIncludes:function(e,t){for(var n=!1,a=0;a<t.length;a++)t[a]===e&&(n=!0);return n}}},I={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{ref:"page",staticClass:"pageBox",on:{scroll:this.pageScroll}},[t("div",{ref:"topBox",staticClass:"topBox"},[t("com-top")],1),this._v(" "),t("com-table",{style:this.tableStyle}),this._v(" "),t("div",{ref:"bottomBox",staticClass:"bottomBox"},[t("el-button",{attrs:{type:"primary",size:"mini",plain:""},on:{click:this.goTo}},[this._v("下一步 -> 生成详细节点计划")])],1)],1)},staticRenderFns:[]};var w=n("VU/8")(b,I,!1,function(e){n("ueuF"),n("+XAg")},"data-v-8dcb2b7c",null).exports,T=n("woOf"),x=n.n(T),E={created:function(){this._countHeight()},data:function(){return{dialogVisible:!1,d_data:{},tableHeight:0}},computed:d()({},Object(c.c)(["next_itemMapList","next_nodeMapList","tableArr","tableActive","pageTypeText","isSubmit"]),Object(c.b)(["next_list"])),methods:{focus:function(){this.$store.commit("saveData",{name:"isComputed_2",obj:!1})},blur:function(){this.$store.commit("saveData",{name:"isComputed_2",obj:!0})},edit:function(e,t){console.log(e);for(var n=e.index,a=e.item_name,i=e[t],r=i.error,o=i.verification_remark,s=i.item_node_change,_=s.is_change,l=s.change_plan_time,d=s.abnormal_reason,c=r?"节点异常处理":"节点编辑",p=this.next_nodeMapList,m=this.pageTypeText,u="",f=0;f<p.length;f++){var v=p[f],h=v.node_id,g=v.node_name;if(h===t){u=g;break}}for(var b=[a,m,u].join(" > "),I="",w=0;w<e.nodeList_0.length;w++){var T=e.nodeList_0[w];T.node_id===t&&(I=T.first_plant_enddate)}var x={index:n,title:c,nodeId:t,node_name:b,first_plant_enddate:I,abnormal_reason:d,is_change:_,change_plan_time:l,verification_remark:o};this.d_data=x,this.dialogVisible=!0},submit:function(){var e=this,t=this.d_data,n=this.next_itemMapList,a=t.index,i=t.nodeId,r=t.first_plant_enddate,o=t.abnormal_reason,s=t.is_change;if(o){var _=0===s?"":this._toggleTime(t.change_plan_time);n[a][i].first_plant_enddate=0===s?r:_,n[a][i].item_node_change=x()({},{abnormal_reason:o,change_plan_time:_,frist_plan_time:r,is_change:s}),setTimeout(function(){e.$store.state.isSubmit&&(e.dialogVisible=!1,e.$message({message:"保存成功",type:"success",duration:1e3}),n[a][i].isProving=!0)},0)}else this.$message.error("请填写调整/异常原因")},objectSpanMethod:function(e){e.row,e.column;var t=e.rowIndex;if(e.columnIndex<4)return t%2?{rowspan:0,colspan:0}:{rowspan:2,colspan:1}},deleteData:function(e){var t=this.next_itemMapList;t.splice(e,1),this.$store.commit("saveData",{name:"next_itemMapList",obj:t})},_toggleTime:function(e){if(e){var t=e.split(/[-//.]/g),n=(new Date).getFullYear(),a="",i="";if(3===t.length){var r=v()(t,3),o=r[0],s=r[1],_=r[2];return isNaN(parseInt(o))||(n="2000".slice(0,-1*String(o).length)+o),isNaN(parseInt(s))||(a=parseInt(s)<10?"0"+parseInt(s):parseInt(s)),isNaN(parseInt(_))||(i=parseInt(_)<10?"0"+parseInt(_):parseInt(_)),parseInt(a)&&parseInt(a)<=12&&parseInt(i)&&parseInt(i)<=31?n+"-"+a+"-"+i:e}if(2===t.length){var l=v()(t,2),d=l[0],c=l[1];return isNaN(parseInt(d))||(a=parseInt(d)<10?"0"+parseInt(d):parseInt(d)),isNaN(parseInt(c))||(i=parseInt(c)),parseInt(a)&&parseInt(a)<=12&&parseInt(i)&&parseInt(i)<10?n+"-"+a+"-0"+i:parseInt(a)&&parseInt(a)<=12&&parseInt(i)&&parseInt(i)<=31?n+"-"+a+"-"+i:e}return e}return e},_countHeight:function(){var e=this,t=0,n=setInterval(function(){if(_()(e.$refs).length){var a=e.$refs.comTableBox;a.clientHeight&&(e.tableHeight=a.clientHeight,clearInterval(n))}t>100&&clearInterval(n),t++},100)},_arrIncludes:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=!1,a=0;a<t.length;a++)t[a]===e&&(n=!0);return n}}},y={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"comTableBox",staticClass:"comTableBox"},[n("el-table",{attrs:{data:e.next_list,size:"mini",border:"",height:e.tableHeight,"span-method":e.objectSpanMethod}},[n("el-table-column",{attrs:{label:"操作",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-popconfirm",{attrs:{title:"确定要删除 "+t.row.item_name+" 吗？",icon:"el-icon-info",iconColor:"red",confirmButtonType:"text"},on:{onConfirm:function(n){e.deleteData(t.row.index/2)}}},[n("el-tag",{staticClass:"deleteBtn hover",attrs:{slot:"reference",size:"mini",plain:""},slot:"reference"},[e._v("删除")])],1)]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"项目名称",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-popover",{attrs:{"popper-class":"comPopover","visible-arrow":!1,placement:"right",trigger:"hover",content:t.row.itemInformation}},[n("span",{attrs:{slot:"reference"},slot:"reference"},[e._v(e._s(t.row.item_name))])])]}}])}),e._v(" "),n("el-table-column",{attrs:{prop:"order_time",label:"下单日期",width:"100"}}),e._v(" "),n("el-table-column",{attrs:{prop:"deliver_date",label:"客人交期",width:"100"}}),e._v(" "),n("el-table-column",{attrs:{width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.index%2?n("span",[e._v("本次调整")]):n("span",[e._v("计划完成")])]}}])}),e._v(" "),e._l(e.next_nodeMapList,function(t){return n("el-table-column",{key:"node_"+t.node_id,attrs:{label:t.node_name,"column-key":t.node_id,width:"150"},scopedSlots:e._u([{key:"default",fn:function(a){return[a.row[t.node_id]?n("div",[a.row.index%2?n("span",[2===a.row[t.node_id].submit_type&&a.row[t.node_id].error?n("div",[n("el-input",{staticClass:"comInput",class:a.row[t.node_id].error?"errorPicker":"",attrs:{size:"mini",placeholder:"请输入异常原因"},model:{value:a.row[t.node_id].item_node_change.abnormal_reason,callback:function(n){e.$set(a.row[t.node_id].item_node_change,"abnormal_reason",n)},expression:"scope.row[item.node_id].item_node_change.abnormal_reason"}})],1):n("div",{staticStyle:{"text-align":"left"}},[a.row[t.node_id].item_node_change&&a.row[t.node_id].item_node_change.change_plan_time?n("p",[e._v("\n                  调整后："+e._s(a.row[t.node_id].item_node_change.change_plan_time)+"\n                ")]):e._e(),e._v(" "),a.row[t.node_id].item_node_change&&a.row[t.node_id].item_node_change.abnormal_reason?n("p",[e._v("\n                  原因："+e._s(a.row[t.node_id].item_node_change.abnormal_reason)+"\n                ")]):e._e()])]):n("div",[2===a.row[t.node_id].submit_type?n("div",[n("el-popover",{attrs:{"popper-class":"comPopover","visible-arrow":!1,placement:"left",trigger:"focus",content:a.row[t.node_id].maxMinText}},[n("el-input",{staticClass:"comInput",class:a.row[t.node_id].error?"errorPicker":"",attrs:{slot:"reference",size:"mini",placeholder:"请输入日期"},on:{focus:e.focus,blur:e.blur},slot:"reference",model:{value:a.row[t.node_id].first_plant_enddate,callback:function(n){e.$set(a.row[t.node_id],"first_plant_enddate",n)},expression:"scope.row[item.node_id].first_plant_enddate"}})],1)],1):e._e(),e._v(" "),1===a.row[t.node_id].submit_type&&a.row[t.node_id].error?n("div",[n("span",{staticClass:"red"},[e._v(e._s(a.row[t.node_id].first_plant_enddate))]),e._v(" "),a.row[t.node_id].error?n("i",{staticClass:"el-icon-warning warningIcon hover",on:{click:function(n){e.edit(a.row,t.node_id)}}}):e._e()]):e._e(),e._v(" "),1!==a.row[t.node_id].submit_type||a.row[t.node_id].error?e._e():n("div",[n("span",{staticClass:"hover",on:{dblclick:function(n){e.edit(a.row,t.node_id)}}},[e._v(e._s(a.row[t.node_id].first_plant_enddate))])])])]):n("span",[e._v("--")])]}}])})})],2),e._v(" "),n("el-dialog",{staticClass:"comDialog",attrs:{title:e.d_data.title,visible:e.dialogVisible,width:"80%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[n("div",{staticClass:"lineBox"},[n("div",{staticClass:"lineLabel"},[e._v("当前异常节点：")]),e._v(" "),n("div",{staticClass:"lineText"},[e._v(e._s(e.d_data.node_name))])]),e._v(" "),n("div",{staticClass:"lineBox"},[n("div",{staticClass:"lineLabel"},[e._v("系统计算日期：")]),e._v(" "),n("div",{staticClass:"lineText"},[e._v(e._s(e.d_data.first_plant_enddate))]),e._v(" "),n("div",{staticClass:"lineLabel"},[e._v("异常原因：")]),e._v(" "),n("div",{staticClass:"lineText"},[e._v(e._s(e.d_data.verification_remark))])]),e._v(" "),n("div",{staticClass:"lineBox"},[n("div",{staticClass:"lineLabel"},[e._v("是否调整日期：")]),e._v(" "),n("div",{staticClass:"lineText"},[n("el-radio",{attrs:{label:1},model:{value:e.d_data.is_change,callback:function(t){e.$set(e.d_data,"is_change",t)},expression:"d_data.is_change"}},[e._v("是")]),e._v(" "),n("el-radio",{attrs:{label:0},model:{value:e.d_data.is_change,callback:function(t){e.$set(e.d_data,"is_change",t)},expression:"d_data.is_change"}},[e._v("否")])],1),e._v(" "),n("div",{staticClass:"lineLabel"},[e._v("调整后日期：")]),e._v(" "),n("div",{staticClass:"lineText"},[n("el-input",{staticClass:"comInput",attrs:{slot:"reference",disabled:0===e.d_data.is_change,size:"mini",placeholder:"请输入日期"},on:{focus:e.focus,blur:e.blur},slot:"reference",model:{value:e.d_data.change_plan_time,callback:function(t){e.$set(e.d_data,"change_plan_time",t)},expression:"d_data.change_plan_time"}})],1)]),e._v(" "),n("div",{staticClass:"lineBox"},[n("div",{staticClass:"lineLabel"},[n("span",{staticClass:"red"},[e._v("*")]),e._v("调整/异常原因：")]),e._v(" "),n("div",{staticClass:"lineText"},[n("el-input",{staticClass:"comInput2",attrs:{size:"mini",placeholder:"请填写调整/异常原因"},model:{value:e.d_data.abnormal_reason,callback:function(t){e.$set(e.d_data,"abnormal_reason",t)},expression:"d_data.abnormal_reason"}})],1)]),e._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.submit}},[e._v("保 存")]),e._v(" "),n("el-button",{attrs:{size:"mini"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")])],1)])],1)},staticRenderFns:[]};var C={components:{ComTable:n("VU/8")(E,y,!1,function(e){n("gtUo"),n("dr0g")},"data-v-905fc0e4",null).exports},data:function(){return{tableStyle:{},scrollTop:0}},created:function(){this._countHeight();var e=(JSON.parse(localStorage.getItem("NOVA_itemGanttType"))||{}).pageType,t=void 0===e?"1":e,n={1:"大货甘特表汇总",1.1:"排产前节点",1.2:"投产节点",2:"大货面料甘特表汇总",3:"大货工厂甘特表"}[t]||"";this.$store.commit("saveData",{name:"pageType",obj:t}),this.$store.commit("saveData",{name:"pageTypeText",obj:n})},computed:{},methods:{goBack:function(){this.$router.go(-1)},submit:function(e){this.$store.dispatch("A_itemCustomNode",{audit_status:e,that:this})},_countHeight:function(){var e=this,t=0,n=setInterval(function(){if(_()(e.$refs).length){var a=e.$refs,i=a.page,r=a.bottomBox;if(i.clientHeight&&r.clientHeight){var o=i.clientHeight-r.clientHeight;e.tableStyle={height:o+"px"},clearInterval(n)}}t>100&&clearInterval(n),t++},100)},pageScroll:function(e){var t=e.target.scrollTop,n=this.scrollTop;Math.abs(t-n)<300?(this.scrollTop=e.target.scrollTop,this.$refs.page.scrollTop=t):this.$refs.page.scrollTop=n},arrIncludes:function(e,t){for(var n=!1,a=0;a<t.length;a++)t[a]===e&&(n=!0);return n}}},M={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"page",staticClass:"pageBox",on:{scroll:e.pageScroll}},[n("com-table",{style:e.tableStyle}),e._v(" "),n("div",{ref:"bottomBox",staticClass:"bottomBox"},[n("el-button",{attrs:{type:"primary",size:"mini",plain:""},on:{click:e.goBack}},[e._v("返回上一页")]),e._v(" "),n("el-button",{attrs:{type:"primary",size:"mini",plain:""},on:{click:function(t){e.submit("1")}}},[e._v("暂存")]),e._v(" "),n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){e.submit("2")}}},[e._v("提交审核")])],1)],1)},staticRenderFns:[]};var L=n("VU/8")(C,M,!1,function(e){n("krfW"),n("hzl4")},"data-v-03bcc3de",null).exports;a.default.use(o.a);var j=new o.a({routes:[{path:"/center",component:w,name:"提报"},{path:"/center2",component:L,name:"生成"},{path:"/",component:w,name:""}]}),D=n("mvHQ"),O=n.n(D),P=n("mtWM"),B=n.n(P),k=n("mw3O"),A=n.n(k),N=n("zL8q"),S=n.n(N);B.a.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded;charset=UTF-8",B.a.interceptors.request.use(function(e){return e});var $=function(e){var t=void 0,n=e.path,a=void 0===n?"":n,i=e.path2,r=void 0===i?"":i,o=e.obj,s=void 0===o?{}:o,_=e.suc,l=void 0===_?function(e){}:_,d=e.err,c=void 0===d?function(e){}:d,p=e.method,m=void 0===p?"post":p,u=e.loading,f=void 0===u?"":u,v=s,h=a+r;if("get"===m){var g=[];for(var b in v)g.push(b+"="+v[b]);h+=g.length?h.indexOf("?")>-1?"&"+g.join("&"):"?"+g.join("&"):""}f&&(t=N.Loading.service({text:f})),B()({method:m,url:h,data:A.a.stringify(v),timeout:0}).then(function(e){l(e.data.data),f&&t.close()}).catch(function(e){c(e),f&&t.close()})},U=window.location.origin+"/nova/",H={"初始化数据":"itemGanttSummaryShowAction.ndo?action=getItemNodeTemple","下一步":"itemGanttSummaryShowAction.ndo?action=generateItemGanttSummary","保存":"itemGanttSummarySaveAction.ndo?action=itemCustomNode"},R=function(e){e.path=U+H[e.name],$(e)},W=n("DIJa");a.default.use(c.a);var K=new c.a.Store({modules:{},state:{isComputed_2:!0,pageType:"",itemids:"",projectList:[],nodeMapList:[],tableArr:["asd"],addProjectList:[],isSubmit:!1,next_itemMapList:[],next_nodeMapList:[]},getters:{next_list:function(e){var t=e.next_itemMapList,n=e.isComputed_2;return W.a.next_list(t,n,e)},itenames:function(e){var t=[];return e.projectList.forEach(function(e){t.push(e.item_name)}),t.join(",")}},mutations:{saveData:function(e,t){var n=t.name,a=t.obj;e[n]=a},createdNewTable:function(e){e.tableArr.push((new Date).getTime())}},actions:{A_getItemNodeTemple:function(e,t){var n=e.state,a=e.commit,i=(e.getters,t.status),r=void 0===i?"初始化":i,o=n.pageType,s=n.itemids;if("创建"===r){var _=(JSON.parse(localStorage.getItem("choiceGanttSummaryItemData"))||{}).itemids;s=void 0===_?"":_}R({name:"初始化数据",obj:{itemIds:s,type:o},loading:"数据初始化中...",suc:function(e){var t=e.itemMapList,i=e.nodeMapList,o=e.itemids;if(t.map(function(e,t){e.nodeTemplateMapList.forEach(function(t){e[t.node_id]=x()({},t,{first_plant_enddate:""})}),e.index=t}),"初始化"===r&&(n.nodeMapList=i,n.itemids=o),"创建"===r){var s={},_=[];n.projectList.forEach(function(e){s[e.item_id]=e,_.push(e)}),t.forEach(function(e){s[e.item_id]||_.push(e)}),n.projectList=_}else n.projectList=t;"创建"===r&&a("createdNewTable")}})},A_generateItemGanttSummary:function(e,t){var n=e.state,a=t.that,i=n.projectList,r=n.nodeMapList,o=n.pageType,s=W.a.returnDatalist(i,r),l=s.datalist,d=s.errorObj;if(_()(d).length){var c=[];for(var p in d){var m=d[p];c.push(p+":"+m.join("、"))}var u=c.join("，");a.$alert("请完善 "+u+" 后再进行下一步操作","",{confirmButtonText:"确定"})}else{R({name:"下一步",obj:{type:o,datalist:l},suc:function(e){localStorage.setItem("asd",O()(e));var t=e.itemMapList,i=e.nodeMapList;n.next_nodeMapList=i;var r=[];t.forEach(function(e){var t={};for(var n in e)t[n]=e[n],"nodeTemplateMapList"===n&&function(){var a={frist_plan_time:"",abnormal_reason:"",is_change:0,change_plan_time:""};t.nodeList_0=[],e[n].map(function(e){e.item_node_change=x()({},a),t.nodeList_0.push(x()({},e))})}();r.push(t)}),n.next_itemMapList=r,a.$router.push({name:"生成"})},err:function(){},loading:"生成中..."})}},A_itemCustomNode:function(e,t){var n=e.state,a=t.audit_status,i=t.that,r=n.pageType,o=n.next_itemMapList,s=n.next_nodeMapList,l=W.a.submitProving(o,s),d=l.itemids,c=l.datalist,p=l.nameObj,m=void 0===p?{}:p;if(_()(m).length){var u=[];for(var f in m){var v=m[f];u.push(v.name+":"+v.arr.join("、"))}var h=u.join("，");i.$alert("请完善 "+h+" 后再提交","",{confirmButtonText:"确定"})}else{var g={type:1,itemids:d,audit_type:r,datalist:O()(c),audit_status:a};R({name:"保存",obj:g,suc:function(e){console.log("保存结果 ----- ",e)}})}}}}),z=(n("tvR6"),n("hKoQ"));n.n(z).a.polyfill(),a.default.use(S.a),new a.default({el:"#app",store:K,router:j,components:{App:r},template:"<App/>"})},YvID:function(e,t){},dr0g:function(e,t){},gtUo:function(e,t){},hzl4:function(e,t){},kQc9:function(e,t){},krfW:function(e,t){},tkU7:function(e,t){},tvR6:function(e,t){},ueuF:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.74198d0131272b80afcf.js.map